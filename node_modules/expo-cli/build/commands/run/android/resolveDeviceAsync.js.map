{"version":3,"file":"resolveDeviceAsync.js","names":["ensureEmulatorOpenAsync","device","devices","Android","getAllAvailableDevicesAsync","bootedDevice","attemptToStartEmulatorOrAssertAsync","CommandError","resolveDeviceAsync","catch","promptForDeviceAsync","Log","log","chalk","dim","name","searchValue","toLowerCase","resolved","find"],"sources":["../../../../src/commands/run/android/resolveDeviceAsync.ts"],"sourcesContent":["import chalk from 'chalk';\nimport { Android } from 'xdl';\n\nimport CommandError from '../../../CommandError';\nimport Log from '../../../log';\n\nasync function ensureEmulatorOpenAsync(device?: Android.Device): Promise<Android.Device> {\n  if (!device) {\n    const devices = await Android.getAllAvailableDevicesAsync();\n    device = devices[0];\n  }\n\n  const bootedDevice = await Android.attemptToStartEmulatorOrAssertAsync(device);\n  if (!bootedDevice) {\n    // TODO: Improve\n    throw new CommandError('Unauthorized');\n  }\n  return bootedDevice;\n}\n\nexport async function resolveDeviceAsync(device?: string | boolean): Promise<Android.Device> {\n  if (!device) {\n    return await ensureEmulatorOpenAsync();\n  }\n\n  const devices: Android.Device[] = await Android.getAllAvailableDevicesAsync().catch(() => []);\n\n  if (device === true) {\n    // --device with no props after\n    const device = await Android.promptForDeviceAsync(devices);\n    if (!device) {\n      throw new CommandError('Select a device to use');\n    }\n    Log.log(chalk.dim`\\u203A Using --device ${device.name}`);\n    return device;\n  }\n  const searchValue = device.toLowerCase();\n  const resolved = devices.find(device => {\n    return device.name.toLowerCase() === searchValue;\n  });\n\n  if (!resolved) {\n    throw new CommandError(`No device name matching \"${device}\"`);\n  }\n\n  return await ensureEmulatorOpenAsync(resolved);\n}\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAA+B;AAE/B,eAAeA,uBAAuB,CAACC,MAAuB,EAA2B;EACvF,IAAI,CAACA,MAAM,EAAE;IACX,MAAMC,OAAO,GAAG,MAAMC,cAAO,CAACC,2BAA2B,EAAE;IAC3DH,MAAM,GAAGC,OAAO,CAAC,CAAC,CAAC;EACrB;EAEA,MAAMG,YAAY,GAAG,MAAMF,cAAO,CAACG,mCAAmC,CAACL,MAAM,CAAC;EAC9E,IAAI,CAACI,YAAY,EAAE;IACjB;IACA,MAAM,KAAIE,uBAAY,EAAC,cAAc,CAAC;EACxC;EACA,OAAOF,YAAY;AACrB;AAEO,eAAeG,kBAAkB,CAACP,MAAyB,EAA2B;EAC3F,IAAI,CAACA,MAAM,EAAE;IACX,OAAO,MAAMD,uBAAuB,EAAE;EACxC;EAEA,MAAME,OAAyB,GAAG,MAAMC,cAAO,CAACC,2BAA2B,EAAE,CAACK,KAAK,CAAC,MAAM,EAAE,CAAC;EAE7F,IAAIR,MAAM,KAAK,IAAI,EAAE;IACnB;IACA,MAAMA,MAAM,GAAG,MAAME,cAAO,CAACO,oBAAoB,CAACR,OAAO,CAAC;IAC1D,IAAI,CAACD,MAAM,EAAE;MACX,MAAM,KAAIM,uBAAY,EAAC,wBAAwB,CAAC;IAClD;IACAI,cAAG,CAACC,GAAG,CAACC,gBAAK,CAACC,GAAI,yBAAwBb,MAAM,CAACc,IAAK,EAAC,CAAC;IACxD,OAAOd,MAAM;EACf;EACA,MAAMe,WAAW,GAAGf,MAAM,CAACgB,WAAW,EAAE;EACxC,MAAMC,QAAQ,GAAGhB,OAAO,CAACiB,IAAI,CAAClB,MAAM,IAAI;IACtC,OAAOA,MAAM,CAACc,IAAI,CAACE,WAAW,EAAE,KAAKD,WAAW;EAClD,CAAC,CAAC;EAEF,IAAI,CAACE,QAAQ,EAAE;IACb,MAAM,KAAIX,uBAAY,EAAE,4BAA2BN,MAAO,GAAE,CAAC;EAC/D;EAEA,OAAO,MAAMD,uBAAuB,CAACkB,QAAQ,CAAC;AAChD"}