{"version":3,"file":"resolvePortAsync.js","names":["resolvePortAsync","projectRoot","reuseExistingPort","defaultPort","fallbackPort","port","parseInt","getenv","int","resolvedPort","choosePortAsync","Log","log","process","env","RCT_METRO_PORT","String"],"sources":["../../../../src/commands/run/utils/resolvePortAsync.ts"],"sourcesContent":["import getenv from 'getenv';\nimport { choosePortAsync } from 'xdl/build/utils/choosePortAsync';\n\nimport Log from '../../../log';\n\nexport async function resolvePortAsync(\n  projectRoot: string,\n  {\n    reuseExistingPort,\n    defaultPort,\n    fallbackPort,\n  }: {\n    reuseExistingPort?: boolean;\n    defaultPort?: string | number;\n    fallbackPort?: number;\n  } = {}\n): Promise<number | null> {\n  let port: number;\n  if (typeof defaultPort === 'string') {\n    port = parseInt(defaultPort, 10);\n  } else if (typeof defaultPort === 'number') {\n    port = defaultPort;\n  } else {\n    port = getenv.int('RCT_METRO_PORT', fallbackPort || 8081);\n  }\n\n  // Only check the port when the bundler is running.\n  const resolvedPort = await choosePortAsync(projectRoot, {\n    defaultPort: port,\n    reuseExistingPort,\n  });\n  if (resolvedPort == null) {\n    Log.log('\\u203A Skipping dev server');\n    // Skip bundling if the port is null\n  } else {\n    // Use the new or resolved port\n    process.env.RCT_METRO_PORT = String(resolvedPort);\n  }\n\n  return resolvedPort;\n}\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAA+B;AAExB,eAAeA,gBAAgB,CACpCC,WAAmB,EACnB;EACEC,iBAAiB;EACjBC,WAAW;EACXC;AAKF,CAAC,GAAG,CAAC,CAAC,EACkB;EACxB,IAAIC,IAAY;EAChB,IAAI,OAAOF,WAAW,KAAK,QAAQ,EAAE;IACnCE,IAAI,GAAGC,QAAQ,CAACH,WAAW,EAAE,EAAE,CAAC;EAClC,CAAC,MAAM,IAAI,OAAOA,WAAW,KAAK,QAAQ,EAAE;IAC1CE,IAAI,GAAGF,WAAW;EACpB,CAAC,MAAM;IACLE,IAAI,GAAGE,iBAAM,CAACC,GAAG,CAAC,gBAAgB,EAAEJ,YAAY,IAAI,IAAI,CAAC;EAC3D;;EAEA;EACA,MAAMK,YAAY,GAAG,MAAM,IAAAC,kCAAe,EAACT,WAAW,EAAE;IACtDE,WAAW,EAAEE,IAAI;IACjBH;EACF,CAAC,CAAC;EACF,IAAIO,YAAY,IAAI,IAAI,EAAE;IACxBE,cAAG,CAACC,GAAG,CAAC,4BAA4B,CAAC;IACrC;EACF,CAAC,MAAM;IACL;IACAC,OAAO,CAACC,GAAG,CAACC,cAAc,GAAGC,MAAM,CAACP,YAAY,CAAC;EACnD;EAEA,OAAOA,YAAY;AACrB"}