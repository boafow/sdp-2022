{"version":3,"file":"logArtifactUrl.js","names":["assertHTTPS","url","UrlUtils","isHttps","CommandError","logArtifactUrl","platform","projectRoot","options","publicUrl","result","getBuildStatusAsync","current","jobs","filter","job","artifacts","Log","nested"],"sources":["../../../src/commands/url/logArtifactUrl.ts"],"sourcesContent":["import { UrlUtils } from 'xdl';\n\nimport CommandError from '../../CommandError';\nimport Log from '../../log';\nimport { BuildJobFields, getBuildStatusAsync } from '../build/getBuildStatusAsync';\n\ntype ArtifactUrlOptions = {\n  publicUrl?: string;\n};\n\nfunction assertHTTPS(url?: string) {\n  if (url && !UrlUtils.isHttps(url)) {\n    throw new CommandError('INVALID_PUBLIC_URL', '--public-url must be a valid HTTPS URL.');\n  }\n}\n\nexport const logArtifactUrl = (platform: 'ios' | 'android') => async (\n  projectRoot: string,\n  options: ArtifactUrlOptions\n) => {\n  assertHTTPS(options.publicUrl);\n\n  const result = await getBuildStatusAsync(projectRoot, {\n    current: false,\n    ...(options.publicUrl ? { publicUrl: options.publicUrl } : {}),\n  });\n\n  const url = result.jobs?.filter((job: BuildJobFields) => job.platform === platform)[0]?.artifacts\n    ?.url;\n\n  if (!url) {\n    throw new CommandError(\n      `No ${platform} binary file found. Use \"expo build:${platform}\" to create one.`\n    );\n  }\n\n  Log.nested(url);\n};\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAmF;AAMnF,SAASA,WAAW,CAACC,GAAY,EAAE;EACjC,IAAIA,GAAG,IAAI,CAACC,eAAQ,CAACC,OAAO,CAACF,GAAG,CAAC,EAAE;IACjC,MAAM,KAAIG,uBAAY,EAAC,oBAAoB,EAAE,yCAAyC,CAAC;EACzF;AACF;AAEO,MAAMC,cAAc,GAAIC,QAA2B,IAAK,OAC7DC,WAAmB,EACnBC,OAA2B,KACxB;EAAA;EACHR,WAAW,CAACQ,OAAO,CAACC,SAAS,CAAC;EAE9B,MAAMC,MAAM,GAAG,MAAM,IAAAC,0CAAmB,EAACJ,WAAW,EAAE;IACpDK,OAAO,EAAE,KAAK;IACd,IAAIJ,OAAO,CAACC,SAAS,GAAG;MAAEA,SAAS,EAAED,OAAO,CAACC;IAAU,CAAC,GAAG,CAAC,CAAC;EAC/D,CAAC,CAAC;EAEF,MAAMR,GAAG,mBAAGS,MAAM,CAACG,IAAI,yEAAX,aAAaC,MAAM,CAAEC,GAAmB,IAAKA,GAAG,CAACT,QAAQ,KAAKA,QAAQ,CAAC,CAAC,CAAC,CAAC,kFAA1E,qBAA4EU,SAAS,0DAArF,sBACRf,GAAG;EAEP,IAAI,CAACA,GAAG,EAAE;IACR,MAAM,KAAIG,uBAAY,EACnB,MAAKE,QAAS,uCAAsCA,QAAS,kBAAiB,CAChF;EACH;EAEAW,cAAG,CAACC,MAAM,CAACjB,GAAG,CAAC;AACjB,CAAC;AAAC"}