{"version":3,"file":"urlAsync.js","names":["actionAsync","projectRoot","options","urlOpts","optsAsync","assertProjectRunningAsync","url","web","getWebAppUrlAsync","UrlUtils","constructDeepLinkAsync","logUrl","printRunInstructionsAsync","handleMobileOptsAsync","ProjectSettings","getCurrentStatusAsync","CommandError","constructWebAppUrlAsync","Log","newLine","printQRCode","log","chalk","underline"],"sources":["../../../src/commands/url/urlAsync.ts"],"sourcesContent":["import chalk from 'chalk';\nimport type { Command } from 'commander';\nimport { ProjectSettings, UrlUtils } from 'xdl';\n\nimport CommandError from '../../CommandError';\nimport Log from '../../log';\nimport urlOpts, { URLOptions } from '../utils/urlOpts';\nimport printRunInstructionsAsync from './printRunInstructionsAsync';\n\ntype ProjectUrlOptions = Command & {\n  web?: boolean;\n};\n\nexport async function actionAsync(projectRoot: string, options: ProjectUrlOptions & URLOptions) {\n  await urlOpts.optsAsync(projectRoot, options);\n\n  await assertProjectRunningAsync(projectRoot);\n\n  const url = options.web\n    ? await getWebAppUrlAsync(projectRoot)\n    : await UrlUtils.constructDeepLinkAsync(projectRoot);\n\n  logUrl(url);\n\n  if (!options.web) {\n    await printRunInstructionsAsync();\n    await urlOpts.handleMobileOptsAsync(projectRoot, options);\n  }\n}\n\nasync function assertProjectRunningAsync(projectRoot: string) {\n  if ((await ProjectSettings.getCurrentStatusAsync(projectRoot)) !== 'running') {\n    throw new CommandError(\n      'NOT_RUNNING',\n      `Project is not running. Please start it with \\`expo start\\`.`\n    );\n  }\n}\n\nasync function getWebAppUrlAsync(projectRoot: string): Promise<string> {\n  const url = await UrlUtils.constructWebAppUrlAsync(projectRoot);\n  if (!url) {\n    throw new CommandError(\n      'NOT_RUNNING',\n      `Webpack dev server is not running. Please start it with \\`expo start:web\\`.`\n    );\n  }\n  return url;\n}\n\nfunction logUrl(url: string) {\n  Log.newLine();\n\n  urlOpts.printQRCode(url);\n\n  Log.log('Your URL is\\n\\n' + chalk.underline(url) + '\\n');\n}\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAoE;AAM7D,eAAeA,WAAW,CAACC,WAAmB,EAAEC,OAAuC,EAAE;EAC9F,MAAMC,kBAAO,CAACC,SAAS,CAACH,WAAW,EAAEC,OAAO,CAAC;EAE7C,MAAMG,yBAAyB,CAACJ,WAAW,CAAC;EAE5C,MAAMK,GAAG,GAAGJ,OAAO,CAACK,GAAG,GACnB,MAAMC,iBAAiB,CAACP,WAAW,CAAC,GACpC,MAAMQ,eAAQ,CAACC,sBAAsB,CAACT,WAAW,CAAC;EAEtDU,MAAM,CAACL,GAAG,CAAC;EAEX,IAAI,CAACJ,OAAO,CAACK,GAAG,EAAE;IAChB,MAAM,IAAAK,oCAAyB,GAAE;IACjC,MAAMT,kBAAO,CAACU,qBAAqB,CAACZ,WAAW,EAAEC,OAAO,CAAC;EAC3D;AACF;AAEA,eAAeG,yBAAyB,CAACJ,WAAmB,EAAE;EAC5D,IAAI,CAAC,MAAMa,sBAAe,CAACC,qBAAqB,CAACd,WAAW,CAAC,MAAM,SAAS,EAAE;IAC5E,MAAM,KAAIe,uBAAY,EACpB,aAAa,EACZ,8DAA6D,CAC/D;EACH;AACF;AAEA,eAAeR,iBAAiB,CAACP,WAAmB,EAAmB;EACrE,MAAMK,GAAG,GAAG,MAAMG,eAAQ,CAACQ,uBAAuB,CAAChB,WAAW,CAAC;EAC/D,IAAI,CAACK,GAAG,EAAE;IACR,MAAM,KAAIU,uBAAY,EACpB,aAAa,EACZ,6EAA4E,CAC9E;EACH;EACA,OAAOV,GAAG;AACZ;AAEA,SAASK,MAAM,CAACL,GAAW,EAAE;EAC3BY,cAAG,CAACC,OAAO,EAAE;EAEbhB,kBAAO,CAACiB,WAAW,CAACd,GAAG,CAAC;EAExBY,cAAG,CAACG,GAAG,CAAC,iBAAiB,GAAGC,gBAAK,CAACC,SAAS,CAACjB,GAAG,CAAC,GAAG,IAAI,CAAC;AAC1D"}