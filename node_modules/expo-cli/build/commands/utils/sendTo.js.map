{"version":3,"file":"sendTo.js","names":["askForSendToAsync","cachedValue","UserSettings","getAsync","Log","nested","recipient","promptEmailAsync","message","initial","undefined","nonInteractiveHelp","mergeAsync","sendTo","getRecipient","sendUrlAsync","url","email","chalk","bold","spinner","ora","start","result","Exp","sendAsync","succeed","e","fail"],"sources":["../../../src/commands/utils/sendTo.ts"],"sourcesContent":["import chalk from 'chalk';\nimport { Exp, UserSettings } from 'xdl';\n\nimport Log from '../../log';\nimport { ora } from '../../utils/ora';\nimport { promptEmailAsync } from '../../utils/prompts';\n\nexport async function askForSendToAsync(): Promise<string> {\n  const cachedValue = await UserSettings.getAsync('sendTo', null);\n  Log.nested(\"Enter an email address and we'll send a link\");\n  const recipient = await promptEmailAsync(\n    {\n      message: `Email address`,\n      initial: cachedValue ?? undefined,\n    },\n    { nonInteractiveHelp: 'Please specify email address with --send-to.' }\n  );\n  await UserSettings.mergeAsync({ sendTo: recipient });\n  return recipient;\n}\n\nexport async function getRecipient(sendTo?: string | boolean): Promise<string> {\n  let recipient: string | null = '';\n  if (sendTo) {\n    if (typeof sendTo !== 'boolean') {\n      recipient = sendTo;\n    } else {\n      recipient = await UserSettings.getAsync('sendTo', null);\n    }\n\n    if (!recipient) {\n      return await askForSendToAsync();\n    }\n  }\n\n  return recipient;\n}\nexport async function sendUrlAsync(url: string, recipient: string) {\n  const email = chalk.bold(recipient);\n  const spinner = ora(`Sending URL to ${email}`).start();\n  try {\n    const result = await Exp.sendAsync(recipient, url);\n    spinner.succeed(`Sent URL to ${email}`);\n    return result;\n  } catch (e: any) {\n    spinner.fail(`Failed to email ${email}: ${e.message}`);\n  }\n}\n"],"mappings":";;;;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAuD;AAEhD,eAAeA,iBAAiB,GAAoB;EACzD,MAAMC,WAAW,GAAG,MAAMC,mBAAY,CAACC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC;EAC/DC,cAAG,CAACC,MAAM,CAAC,8CAA8C,CAAC;EAC1D,MAAMC,SAAS,GAAG,MAAM,IAAAC,2BAAgB,EACtC;IACEC,OAAO,EAAG,eAAc;IACxBC,OAAO,EAAER,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAIS;EAC1B,CAAC,EACD;IAAEC,kBAAkB,EAAE;EAA+C,CAAC,CACvE;EACD,MAAMT,mBAAY,CAACU,UAAU,CAAC;IAAEC,MAAM,EAAEP;EAAU,CAAC,CAAC;EACpD,OAAOA,SAAS;AAClB;AAEO,eAAeQ,YAAY,CAACD,MAAyB,EAAmB;EAC7E,IAAIP,SAAwB,GAAG,EAAE;EACjC,IAAIO,MAAM,EAAE;IACV,IAAI,OAAOA,MAAM,KAAK,SAAS,EAAE;MAC/BP,SAAS,GAAGO,MAAM;IACpB,CAAC,MAAM;MACLP,SAAS,GAAG,MAAMJ,mBAAY,CAACC,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC;IACzD;IAEA,IAAI,CAACG,SAAS,EAAE;MACd,OAAO,MAAMN,iBAAiB,EAAE;IAClC;EACF;EAEA,OAAOM,SAAS;AAClB;AACO,eAAeS,YAAY,CAACC,GAAW,EAAEV,SAAiB,EAAE;EACjE,MAAMW,KAAK,GAAGC,gBAAK,CAACC,IAAI,CAACb,SAAS,CAAC;EACnC,MAAMc,OAAO,GAAG,IAAAC,UAAG,EAAE,kBAAiBJ,KAAM,EAAC,CAAC,CAACK,KAAK,EAAE;EACtD,IAAI;IACF,MAAMC,MAAM,GAAG,MAAMC,UAAG,CAACC,SAAS,CAACnB,SAAS,EAAEU,GAAG,CAAC;IAClDI,OAAO,CAACM,OAAO,CAAE,eAAcT,KAAM,EAAC,CAAC;IACvC,OAAOM,MAAM;EACf,CAAC,CAAC,OAAOI,CAAM,EAAE;IACfP,OAAO,CAACQ,IAAI,CAAE,mBAAkBX,KAAM,KAAIU,CAAC,CAACnB,OAAQ,EAAC,CAAC;EACxD;AACF"}