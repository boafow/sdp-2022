{"version":3,"file":"SetupIosDist.js","names":["SetupIosDist","constructor","app","open","ctx","user","Error","configuredDistCert","ios","getDistCert","isValid","iosDistView","validateDistributionCertificate","CreateOrReuseDistributionCert"],"sources":["../../../src/credentials/views/SetupIosDist.ts"],"sourcesContent":["import { AppLookupParams } from '../api/IosApi';\nimport { Context, IView } from '../context';\nimport * as iosDistView from './IosDistCert';\n\nexport class SetupIosDist implements IView {\n  constructor(private app: AppLookupParams) {}\n\n  async open(ctx: Context): Promise<IView | null> {\n    if (!ctx.user) {\n      throw new Error(`This workflow requires you to be logged in.`);\n    }\n\n    const configuredDistCert = await ctx.ios.getDistCert(this.app);\n\n    if (configuredDistCert) {\n      // we dont need to setup if we have a valid dist cert on file\n      const isValid = await iosDistView.validateDistributionCertificate(ctx, configuredDistCert);\n      if (isValid) {\n        return null;\n      }\n    }\n\n    return new iosDistView.CreateOrReuseDistributionCert(this.app);\n  }\n}\n"],"mappings":";;;;;;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAA6C;AAAA;AAEtC,MAAMA,YAAY,CAAkB;EACzCC,WAAW,CAASC,GAAoB,EAAE;IAAA,KAAtBA,GAAoB,GAApBA,GAAoB;EAAG;EAE3C,MAAMC,IAAI,CAACC,GAAY,EAAyB;IAC9C,IAAI,CAACA,GAAG,CAACC,IAAI,EAAE;MACb,MAAM,IAAIC,KAAK,CAAE,6CAA4C,CAAC;IAChE;IAEA,MAAMC,kBAAkB,GAAG,MAAMH,GAAG,CAACI,GAAG,CAACC,WAAW,CAAC,IAAI,CAACP,GAAG,CAAC;IAE9D,IAAIK,kBAAkB,EAAE;MACtB;MACA,MAAMG,OAAO,GAAG,MAAMC,WAAW,GAACC,+BAA+B,CAACR,GAAG,EAAEG,kBAAkB,CAAC;MAC1F,IAAIG,OAAO,EAAE;QACX,OAAO,IAAI;MACb;IACF;IAEA,OAAO,KAAIC,WAAW,GAACE,6BAA6B,EAAC,IAAI,CAACX,GAAG,CAAC;EAChE;AACF;AAAC"}