{"version":3,"file":"handleErrors.js","names":["handleErrorsAsync","err","command","AbortCommandError","SilentError","isCommandError","isPluginError","AssertionError","Log","error","message","_isApiError","isXDLError","isConfigError","isJsonFileError","isPackageManagerError","code","addNewLineIfNone","formatStackTrace","stacktrace","stack","chalk","gray"],"sources":["../../src/utils/handleErrors.ts"],"sourcesContent":["import { AssertionError } from 'assert';\nimport chalk from 'chalk';\n\nimport { AbortCommandError, SilentError } from '../CommandError';\nimport Log from '../log';\n\nexport async function handleErrorsAsync(err: any, { command = '[unknown]' }: { command?: string }) {\n  // TODO: Find better ways to consolidate error messages\n  if (err instanceof AbortCommandError || err instanceof SilentError) {\n    // Do nothing when a prompt is cancelled or the error is logged in a pretty way.\n  } else if (err.isCommandError || err.isPluginError || err instanceof AssertionError) {\n    Log.error(err.message);\n  } else if (err._isApiError) {\n    Log.error(err.message);\n  } else if (err.isXDLError || err.isConfigError) {\n    Log.error(err.message);\n  } else if (err.isJsonFileError || err.isPackageManagerError) {\n    if (err.code === 'EJSONEMPTY') {\n      // Empty JSON is an easy bug to debug. Often this is thrown for package.json or app.json being empty.\n      Log.error(err.message);\n    } else {\n      Log.addNewLineIfNone();\n      Log.error(err.message);\n      const { formatStackTrace } = await import('./formatStackTrace');\n      const stacktrace = formatStackTrace(err.stack, command);\n      Log.error(chalk.gray(stacktrace));\n    }\n  } else {\n    Log.error(err.message);\n    Log.error(chalk.gray(err.stack));\n  }\n\n  //   process.exit(1);\n}\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAyB;AAAA;AAAA;AAElB,eAAeA,iBAAiB,CAACC,GAAQ,EAAE;EAAEC,OAAO,GAAG;AAAkC,CAAC,EAAE;EACjG;EACA,IAAID,GAAG,YAAYE,iCAAiB,IAAIF,GAAG,YAAYG,2BAAW,EAAE;IAClE;EAAA,CACD,MAAM,IAAIH,GAAG,CAACI,cAAc,IAAIJ,GAAG,CAACK,aAAa,IAAIL,GAAG,YAAYM,wBAAc,EAAE;IACnFC,cAAG,CAACC,KAAK,CAACR,GAAG,CAACS,OAAO,CAAC;EACxB,CAAC,MAAM,IAAIT,GAAG,CAACU,WAAW,EAAE;IAC1BH,cAAG,CAACC,KAAK,CAACR,GAAG,CAACS,OAAO,CAAC;EACxB,CAAC,MAAM,IAAIT,GAAG,CAACW,UAAU,IAAIX,GAAG,CAACY,aAAa,EAAE;IAC9CL,cAAG,CAACC,KAAK,CAACR,GAAG,CAACS,OAAO,CAAC;EACxB,CAAC,MAAM,IAAIT,GAAG,CAACa,eAAe,IAAIb,GAAG,CAACc,qBAAqB,EAAE;IAC3D,IAAId,GAAG,CAACe,IAAI,KAAK,YAAY,EAAE;MAC7B;MACAR,cAAG,CAACC,KAAK,CAACR,GAAG,CAACS,OAAO,CAAC;IACxB,CAAC,MAAM;MACLF,cAAG,CAACS,gBAAgB,EAAE;MACtBT,cAAG,CAACC,KAAK,CAACR,GAAG,CAACS,OAAO,CAAC;MACtB,MAAM;QAAEQ;MAAiB,CAAC,GAAG,mEAAa,oBAAoB,GAAC;MAC/D,MAAMC,UAAU,GAAGD,gBAAgB,CAACjB,GAAG,CAACmB,KAAK,EAAElB,OAAO,CAAC;MACvDM,cAAG,CAACC,KAAK,CAACY,gBAAK,CAACC,IAAI,CAACH,UAAU,CAAC,CAAC;IACnC;EACF,CAAC,MAAM;IACLX,cAAG,CAACC,KAAK,CAACR,GAAG,CAACS,OAAO,CAAC;IACtBF,cAAG,CAACC,KAAK,CAACY,gBAAK,CAACC,IAAI,CAACrB,GAAG,CAACmB,KAAK,CAAC,CAAC;EAClC;;EAEA;AACF"}