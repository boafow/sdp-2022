{"version":3,"file":"IosWorkspace.js","names":["getPaths","context","iosProjectDirectory","projectName","supportingDirectory","projectRootDirectory","build","isExpoClientBuild","isAnonymous","config","name","projectNameLabel","replace","toLowerCase","Error","type","data","projectPath","path","join","dirname","ios","workspaceSourcePath","archivePath","intermediatesDirectory"],"sources":["../../src/detach/IosWorkspace.ts"],"sourcesContent":["import path from 'path';\n\n/**\n *  paths returned:\n *    iosProjectDirectory - root directory of an (uncompiled) xcworkspace and obj-c source tree\n *    projectName - xcworkspace project name normalized from context.config\n *    supportingDirectory - location of Info.plist, xib files, etc. during configuration.\n *      for an unbuilt app this is underneath iosProjectDirectory. for a compiled app it's just\n *      a path to the flat xcarchive.\n *    intermediatesDirectory - temporary spot to write whatever files are needed during the\n *      detach/build process but can be discarded afterward.\n */\nfunction getPaths(context: any) {\n  let iosProjectDirectory;\n  let projectName;\n  let supportingDirectory;\n  let projectRootDirectory;\n\n  if (context.build.isExpoClientBuild()) {\n    projectName = 'Exponent';\n  } else if (context.isAnonymous()) {\n    projectName = 'ExpoKitApp';\n  } else if (context.config && context.config.name) {\n    const projectNameLabel = context.config.name;\n    projectName = projectNameLabel.replace(/[^a-z0-9_-]/gi, '-').toLowerCase();\n  } else {\n    throw new Error('Cannot configure an Expo project with no name.');\n  }\n  if (context.type === 'user') {\n    projectRootDirectory = context.data.projectPath;\n    iosProjectDirectory = path.join(context.data.projectPath, 'ios');\n    supportingDirectory = path.join(iosProjectDirectory, projectName, 'Supporting');\n  } else if (context.type === 'service') {\n    projectRootDirectory = path.dirname(context.build.ios.workspaceSourcePath);\n    iosProjectDirectory = context.build.ios.workspaceSourcePath;\n    if (context.data.archivePath) {\n      // compiled archive has a flat NSBundle\n      supportingDirectory = context.data.archivePath;\n    } else {\n      supportingDirectory = path.join(iosProjectDirectory, projectName, 'Supporting');\n    }\n  } else {\n    throw new Error(`Unsupported StandaloneContext type: ${context.type}`);\n  }\n  // sandbox intermediates directory by workspace so that concurrently operating\n  // contexts do not interfere with one another.\n  const intermediatesDirectory = path.join(\n    iosProjectDirectory,\n    context.build.isExpoClientBuild() ? 'ExponentIntermediates' : 'ExpoKitIntermediates'\n  );\n  return {\n    projectRootDirectory,\n    intermediatesDirectory,\n    iosProjectDirectory,\n    projectName,\n    supportingDirectory,\n  };\n}\n\nexport { getPaths };\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAwB;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,QAAQ,CAACC,OAAY,EAAE;EAC9B,IAAIC,mBAAmB;EACvB,IAAIC,WAAW;EACf,IAAIC,mBAAmB;EACvB,IAAIC,oBAAoB;EAExB,IAAIJ,OAAO,CAACK,KAAK,CAACC,iBAAiB,EAAE,EAAE;IACrCJ,WAAW,GAAG,UAAU;EAC1B,CAAC,MAAM,IAAIF,OAAO,CAACO,WAAW,EAAE,EAAE;IAChCL,WAAW,GAAG,YAAY;EAC5B,CAAC,MAAM,IAAIF,OAAO,CAACQ,MAAM,IAAIR,OAAO,CAACQ,MAAM,CAACC,IAAI,EAAE;IAChD,MAAMC,gBAAgB,GAAGV,OAAO,CAACQ,MAAM,CAACC,IAAI;IAC5CP,WAAW,GAAGQ,gBAAgB,CAACC,OAAO,CAAC,eAAe,EAAE,GAAG,CAAC,CAACC,WAAW,EAAE;EAC5E,CAAC,MAAM;IACL,MAAM,IAAIC,KAAK,CAAC,gDAAgD,CAAC;EACnE;EACA,IAAIb,OAAO,CAACc,IAAI,KAAK,MAAM,EAAE;IAC3BV,oBAAoB,GAAGJ,OAAO,CAACe,IAAI,CAACC,WAAW;IAC/Cf,mBAAmB,GAAGgB,eAAI,CAACC,IAAI,CAAClB,OAAO,CAACe,IAAI,CAACC,WAAW,EAAE,KAAK,CAAC;IAChEb,mBAAmB,GAAGc,eAAI,CAACC,IAAI,CAACjB,mBAAmB,EAAEC,WAAW,EAAE,YAAY,CAAC;EACjF,CAAC,MAAM,IAAIF,OAAO,CAACc,IAAI,KAAK,SAAS,EAAE;IACrCV,oBAAoB,GAAGa,eAAI,CAACE,OAAO,CAACnB,OAAO,CAACK,KAAK,CAACe,GAAG,CAACC,mBAAmB,CAAC;IAC1EpB,mBAAmB,GAAGD,OAAO,CAACK,KAAK,CAACe,GAAG,CAACC,mBAAmB;IAC3D,IAAIrB,OAAO,CAACe,IAAI,CAACO,WAAW,EAAE;MAC5B;MACAnB,mBAAmB,GAAGH,OAAO,CAACe,IAAI,CAACO,WAAW;IAChD,CAAC,MAAM;MACLnB,mBAAmB,GAAGc,eAAI,CAACC,IAAI,CAACjB,mBAAmB,EAAEC,WAAW,EAAE,YAAY,CAAC;IACjF;EACF,CAAC,MAAM;IACL,MAAM,IAAIW,KAAK,CAAE,uCAAsCb,OAAO,CAACc,IAAK,EAAC,CAAC;EACxE;EACA;EACA;EACA,MAAMS,sBAAsB,GAAGN,eAAI,CAACC,IAAI,CACtCjB,mBAAmB,EACnBD,OAAO,CAACK,KAAK,CAACC,iBAAiB,EAAE,GAAG,uBAAuB,GAAG,sBAAsB,CACrF;EACD,OAAO;IACLF,oBAAoB;IACpBmB,sBAAsB;IACtBtB,mBAAmB;IACnBC,WAAW;IACXC;EACF,CAAC;AACH"}