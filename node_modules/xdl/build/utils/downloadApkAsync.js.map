{"version":3,"file":"downloadApkAsync.js","names":["_apkCacheDirectory","dotExpoHomeDirectory","UserSettings","dir","path","join","fs","mkdirpSync","downloadApkAsync","url","downloadProgressCallback","versions","Versions","versionsAsync","androidUrl","filename","parse","name","apkPath","pathExists","downloadAppAsync","undefined"],"sources":["../../src/utils/downloadApkAsync.ts"],"sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\n\nimport { downloadAppAsync, UserSettings, Versions } from '../internal';\n\nfunction _apkCacheDirectory() {\n  const dotExpoHomeDirectory = UserSettings.dotExpoHomeDirectory();\n  const dir = path.join(dotExpoHomeDirectory, 'android-apk-cache');\n  fs.mkdirpSync(dir);\n  return dir;\n}\n\nexport async function downloadApkAsync(\n  url?: string,\n  downloadProgressCallback?: (roundedProgress: number) => void\n) {\n  if (!url) {\n    const versions = await Versions.versionsAsync();\n    url = versions.androidUrl;\n  }\n\n  const filename = path.parse(url).name;\n  const apkPath = path.join(_apkCacheDirectory(), `${filename}.apk`);\n\n  if (await fs.pathExists(apkPath)) {\n    return apkPath;\n  }\n\n  await downloadAppAsync(url, apkPath, undefined, downloadProgressCallback);\n  return apkPath;\n}\n"],"mappings":";;;;;;AAAA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AACA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAEA;EAAA;EAAA;IAAA;EAAA;EAAA;AAAA;AAAuE;AAEvE,SAASA,kBAAkB,GAAG;EAC5B,MAAMC,oBAAoB,GAAGC,wBAAY,CAACD,oBAAoB,EAAE;EAChE,MAAME,GAAG,GAAGC,eAAI,CAACC,IAAI,CAACJ,oBAAoB,EAAE,mBAAmB,CAAC;EAChEK,kBAAE,CAACC,UAAU,CAACJ,GAAG,CAAC;EAClB,OAAOA,GAAG;AACZ;AAEO,eAAeK,gBAAgB,CACpCC,GAAY,EACZC,wBAA4D,EAC5D;EACA,IAAI,CAACD,GAAG,EAAE;IACR,MAAME,QAAQ,GAAG,MAAMC,oBAAQ,CAACC,aAAa,EAAE;IAC/CJ,GAAG,GAAGE,QAAQ,CAACG,UAAU;EAC3B;EAEA,MAAMC,QAAQ,GAAGX,eAAI,CAACY,KAAK,CAACP,GAAG,CAAC,CAACQ,IAAI;EACrC,MAAMC,OAAO,GAAGd,eAAI,CAACC,IAAI,CAACL,kBAAkB,EAAE,EAAG,GAAEe,QAAS,MAAK,CAAC;EAElE,IAAI,MAAMT,kBAAE,CAACa,UAAU,CAACD,OAAO,CAAC,EAAE;IAChC,OAAOA,OAAO;EAChB;EAEA,MAAM,IAAAE,4BAAgB,EAACX,GAAG,EAAES,OAAO,EAAEG,SAAS,EAAEX,wBAAwB,CAAC;EACzE,OAAOQ,OAAO;AAChB"}